<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="theme-color" content="#0b0b0c" />
  <title>–ú–æ–∏ —Ñ–∏–Ω–∞–Ω—Å—ã</title>

  <link rel="stylesheet" href="styles.css" />
  <link rel="manifest" href="manifest.json" />
</head>
<body>
<div id="authScreen" <div style="
  width:320px;
  background:#111;
  padding:20px;
  border-radius:16px;
  color:white;
  text-align:center;
">
  <h2>–í—Ö–æ–¥</h2>
  <p style="opacity:.8;margin-top:6px">–¢–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ Google</p>

  <button id="googleBtn" style="width:100%;padding:12px;margin-top:14px;">
    –í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Google
  </button>

  <p id="authError" style="color:#f66;margin-top:10px;"></p>
</div>

  <div style="
    width:320px;
    background:#111;
    padding:20px;
    border-radius:16px;
    color:white;
    text-align:center;
  ">
    <h2>–í—Ö–æ–¥</h2>

    <input id="email" placeholder="Email" style="width:100%;padding:12px;margin:6px 0;border-radius:10px;" />
    <input id="password" type="password" placeholder="–ü–∞—Ä–æ–ª—å" style="width:100%;padding:12px;margin:6px 0;border-radius:10px;" />

    <button id="loginBtn" style="width:100%;padding:12px;margin-top:10px;">–í–æ–π—Ç–∏</button>
    <button id="registerBtn" style="width:100%;padding:12px;margin-top:6px;">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>

    <button id="googleBtn" style="width:100%;padding:12px;margin-top:10px;">
      –í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Google
    </button>

    <p id="authError" style="color:#f66;"></p>
  </div>
</div>

  <!-- AUTH / LOCK -->
  <div id="auth" class="screen auth">
    <div class="authCard">
      <h1>–ú–æ–∏ —Ñ–∏–Ω–∞–Ω—Å—ã</h1>
      <p class="muted">–ó–∞—â–∏—â–µ–Ω–æ. –û—Ç–∫—Ä–æ–π —á–µ—Ä–µ–∑ FaceID/Passkey.</p>

      <div class="authActions">
        <button id="btnUnlock" class="primary">–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å</button>
        <button id="btnSetupPasskey" class="ghost">–ù–∞—Å—Ç—Ä–æ–∏—Ç—å FaceID/Passkey</button>
      </div>

      <div class="divider"></div>

      <div class="pinBox">
        <p class="muted small">–ï—Å–ª–∏ FaceID –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω ‚Äî PIN (–∑–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç)</p>
        <div class="pinRow">
          <input id="pinInput" type="password" inputmode="numeric" placeholder="PIN (4‚Äì8 —Ü–∏—Ñ—Ä)" />
          <button id="btnSetPin" class="ghost">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å PIN</button>
        </div>
      </div>

      <p id="authMsg" class="muted small"></p>
    </div>
  </div>

  <!-- APP -->
  <div id="app" class="screen hidden">
    <header class="top">
      <div class="topRow">
        <div>
          <div class="titleRow">
            <h2>–ì–ª–∞–≤–Ω–∞—è</h2>
            <button id="btnLock" class="ghost smallBtn">üîí</button>
          </div>
          <p class="muted small" id="periodLabel">–ü–µ—Ä–∏–æ–¥: —ç—Ç–æ—Ç –º–µ—Å—è—Ü</p>
        </div>

        <div class="topRight">
          <select id="period" class="select">
            <option value="month">–≠—Ç–æ—Ç –º–µ—Å—è—Ü</option>
            <option value="today">–°–µ–≥–æ–¥–Ω—è</option>
            <option value="range">–î–∏–∞–ø–∞–∑–æ–Ω</option>
          </select>

          <div id="rangeBox" class="rangeBox hidden">
            <input id="fromDate" type="date" />
            <input id="toDate" type="date" />
          </div>

          <div class="topMenu">
            <button id="btnExport" class="ghost">Export</button>
            <label class="ghost fileBtn">
              Import
              <input id="importFile" type="file" accept="application/json" hidden />
            </label>
          </div>
        </div>
      </div>
    </header>

    <main class="wrap">
      <!-- Donut card -->
      <section class="card center">
        <div class="donutWrap">
          <svg id="donut" viewBox="0 0 120 120" class="donut">
            <circle class="donutTrack" cx="60" cy="60" r="44"></circle>
            <circle id="segIncome" class="donutSeg income" cx="60" cy="60" r="44"></circle>
            <circle id="segExpense" class="donutSeg expense" cx="60" cy="60" r="44"></circle>
          </svg>

          <div class="donutCenter">
            <div class="muted small">–ë–∞–ª–∞–Ω—Å</div>
            <div id="balance" class="balance">0</div>
            <div id="miniTotals" class="muted tiny">‚Äî</div>
          </div>
        </div>

        <div class="bigBtns">
          <button id="btnMinus" class="big red">‚ûñ –†–∞—Å—Ö–æ–¥</button>
          <button id="btnPlus" class="big green">‚ûï –î–æ—Ö–æ–¥</button>
        </div>
      </section>

      <!-- Category breakdown -->
      <section class="card">
        <div class="rowBetween">
          <h3>–ö—É–¥–∞ —É—Ö–æ–¥—è—Ç —Ä–∞—Å—Ö–æ–¥—ã</h3>
          <button id="btnAllTx" class="ghost smallBtn">–°–ø–∏—Å–æ–∫</button>
        </div>
        <div id="catBreakdown" class="breakdown">
          <!-- filled by JS -->
        </div>
        <p class="muted tiny" id="breakdownHint">–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç % –æ—Ç —Ä–∞—Å—Ö–æ–¥–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥.</p>
      </section>
    </main>
  </div>

  <!-- Transactions list screen -->
  <div id="listScreen" class="screen hidden">
    <header class="top">
      <div class="topRow">
        <div>
          <div class="titleRow">
            <h2>–û–ø–µ—Ä–∞—Ü–∏–∏</h2>
            <button id="btnBack" class="ghost smallBtn">‚Üê</button>
          </div>
          <p class="muted small" id="listLabel">‚Äî</p>
        </div>
        <div class="filters">
          <select id="fType" class="select">
            <option value="all">–í—Å–µ</option>
            <option value="expense">–†–∞—Å—Ö–æ–¥—ã</option>
            <option value="income">–î–æ—Ö–æ–¥—ã</option>
          </select>
          <select id="fCurrency" class="select">
            <option value="all">UZS+USD</option>
            <option value="UZS">UZS</option>
            <option value="USD">USD</option>
          </select>
          <select id="fMethod" class="select">
            <option value="all">–ö–∞—Ä—Ç–∞+–ù–∞–ª</option>
            <option value="cash">–ù–∞–ª–∏—á–∫–∞</option>
            <option value="card">–ö–∞—Ä—Ç–∞</option>
          </select>
          <input id="search" type="search" class="select" placeholder="–ø–æ–∏—Å–∫‚Ä¶" />
        </div>
      </div>
    </header>

    <main class="wrap">
      <section class="card">
        <ul id="txList" class="txList"></ul>
        <p class="muted tiny">–£–¥–∞–ª–µ–Ω–∏–µ ‚Äî –∫–Ω–æ–ø–∫–∞ —Å–ø—Ä–∞–≤–∞.</p>
      </section>
    </main>
  </div>

  <!-- Add transaction modal -->
  <div id="modal" class="modal hidden">
    <div class="sheet">
      <div class="sheetTop">
        <div>
          <h3 id="modalTitle">–î–æ–±–∞–≤–∏—Ç—å</h3>
          <p class="muted tiny" id="modalSub">–ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–µ—Å–ª–∏ —Å—É–º–º–∞ –≤–≤–µ–¥–µ–Ω–∞).</p>
        </div>
        <button id="btnClose" class="ghost smallBtn">‚úï</button>
      </div>

      <div class="grid">
        <div>
          <label>–î–∞—Ç–∞</label>
          <input id="mDate" type="date" />
        </div>
        <div>
          <label>–°—É–º–º–∞</label>
          <input id="mAmount" type="number" inputmode="decimal" step="0.01" min="0" placeholder="0" />
        </div>

        <div>
          <label>–í–∞–ª—é—Ç–∞</label>
          <select id="mCurrency" class="select">
            <option value="UZS">UZS</option>
            <option value="USD">USD</option>
          </select>
        </div>

        <div>
          <label>–û–ø–ª–∞—Ç–∞</label>
          <select id="mMethod" class="select">
            <option value="cash">–ù–∞–ª–∏—á–∫–∞</option>
            <option value="card">–ö–∞—Ä—Ç–∞</option>
          </select>
        </div>

        <div class="full">
          <label>–ó–∞–º–µ—Ç–∫–∞</label>
          <input id="mNote" type="text" placeholder="–∫—Ä–∞—Ç–∫–æ –∑–∞—á–µ–º / –æ—Ç–∫—É–¥–∞" />
        </div>
      </div>

      <div class="rowBetween mt">
        <h3>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</h3>
        <button id="btnAddCategory" class="greenBtn">‚ûï</button>
      </div>

      <div id="catGrid" class="catGrid"></div>

      <div class="sheetBottom">
        <button id="btnSaveManual" class="primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        <button id="btnCancel" class="ghost">–û—Ç–º–µ–Ω–∞</button>
      </div>

      <p id="toast" class="toast hidden">–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ ‚úÖ</p>
    </div>
  </div>

  <!-- Add category modal -->
  <div id="catModal" class="modal hidden">
    <div class="sheet">
      <div class="sheetTop">
        <div>
          <h3>–ù–æ–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è</h3>
          <p class="muted tiny">–ò–∫–æ–Ω–∫–∞ ‚Äî –º–æ–∂–Ω–æ emoji (üöó üì± üè†).</p>
        </div>
        <button id="btnCloseCat" class="ghost smallBtn">‚úï</button>
      </div>

      <div class="grid">
        <div class="full">
          <label>–ù–∞–∑–≤–∞–Ω–∏–µ</label>
          <input id="newCatName" type="text" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä: –ö–æ—Ñ–µ" />
        </div>
        <div>
          <label>–ò–∫–æ–Ω–∫–∞</label>
          <input id="newCatIcon" type="text" placeholder="‚òïÔ∏è" />
        </div>
        <div>
          <label>–¢–∏–ø</label>
          <select id="newCatType" class="select">
            <option value="expense">–†–∞—Å—Ö–æ–¥</option>
            <option value="income">–î–æ—Ö–æ–¥</option>
          </select>
        </div>
      </div>

      <div class="sheetBottom">
        <button id="btnCreateCat" class="primary">–î–æ–±–∞–≤–∏—Ç—å</button>
        <button id="btnCancelCat" class="ghost">–û—Ç–º–µ–Ω–∞</button>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
